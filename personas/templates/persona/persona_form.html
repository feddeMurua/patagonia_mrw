{% extends "base/base_form.html" %}
{% load staticfiles bootstrap3 %}

{% block title %}Persona{% endblock %}

{% block header-title %}Alta/Modificacion de Persona{% endblock %}

{% block url-volver %}{% url url_return %}{% endblock %}

{% block form-right %}
    <div class="col-xs-12 col-md-5">
        {% include 'domicilio/cuadro_domicilio.html' %}
    </div>
{% endblock %}

{% block btn-cancelar %}
    <a class="btn btn-danger btn-cancelar" href="{% url url_return %}">Cancelar</a>
{% endblock %}

{% block more-scripts %}
    <script>
        $.datepicker.setDefaults({
            maxDate: new Date()
        });

        $(function(){
            $("#id_documentacion_retirada").checkboxradio();
        });

        var dni = $('#id_dni');

        dni.mask('ZZ99000000', {translation:  {'Z': {pattern: /a-zA-Z0-9/, optional: true}}});
        $('#id_cuit').mask('00-00000000-0');

        dni.focusout( function(){
            $.ajax({
                url: "{% url 'personas:verificar_documento' %}",
                method: 'GET',
                data: {
                    documento: dni.val()
                },
                success: function(data){
                    if(data['existe']){
                        dni.after('<div class="alert alert-danger"><strong>Ya existe una persona registrada con el DNI ingresado</strong></div>')
                    }
                }
            });
        });

        dni.focusin( function (){
            if ($('.alert')) {
                $('.alert').remove()
            }
        });
    </script>
{% endblock %}
